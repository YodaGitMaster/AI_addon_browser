<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Page Chat</title>
    <link rel="stylesheet" href="sidebar.css">
</head>

<body>
    <div class="sidebar-container">
        <!-- Header with page info -->
        <div class="header">
            <div class="header-top">
                <div class="status-indicator">
                    <span class="status-dot disconnected" id="statusDot"></span>
                    <span class="status-text" id="statusText">Connecting...</span>
                </div>
                <div class="header-actions">
                    <button id="settingsButton" class="settings-button" title="Settings">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path
                                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                            </path>
                        </svg>
                    </button>
                    <button id="editContextButton" class="edit-context-button" title="Select tabs for context">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit Context
                    </button>
                    <button id="exportButton" class="export-button" title="Export chat as Markdown">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7,10 12,15 17,10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Export
                    </button>
                </div>
            </div>
            <div class="page-info" id="pageInfo">
                <div class="page-title" id="pageTitle">Loading page...</div>
                <div class="page-url" id="pageUrl"></div>
            </div>
        </div>

        <!-- Chat messages area -->
        <div class="chat-container" id="chatContainer">
            <div class="chat-messages" id="chatMessages">
                <div class="system-message">
                    <div class="message-content">
                        <p>👋 Hi! I'm your AI assistant with advanced analysis capabilities. I can help you with:</p>
                        <ul>
                            <li>📚 Generate study questions and flashcards</li>
                            <li>✅ Fact-check claims and statements</li>
                            <li>📊 Extract and analyze tables</li>
                            <li>💰 Provide financial analysis</li>
                            <li>📈 Analyze charts and graphs</li>
                            <li>🖼️ Analyze images and visual content</li>
                            <li>🔍 General page analysis and explanations</li>
                        </ul>
                        <p><strong>💡 Tip:</strong> Right-click on any page or selected text for quick AI analysis
                            options!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input area -->
        <div class="input-container">
            <div class="input-wrapper">
                <textarea id="messageInput" placeholder="Ask me anything about this page..." rows="1"></textarea>
                <button id="sendButton" class="send-button" disabled>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 2L11 13"></path>
                        <path d="M22 2L15 22L11 13L2 9L22 2Z"></path>
                    </svg>
                </button>
            </div>
            <div class="input-suggestions">
                <button class="suggestion-btn" data-message="Summarize this page">📄 Summarize this page</button>
                <button class="suggestion-btn" data-message="Do a quick summary">⚡ Quick Summary</button>
                <button class="suggestion-btn"
                    data-message="What are the most important details I should know from this page?">🔍 Find Key
                    Information</button>
                <button class="suggestion-btn" data-message="What are the main points? in bullet points">📌 Main
                    Points</button>
                <button class="suggestion-btn" data-message="Help me create organized notes from this content">📝 Take
                    Notes</button>
                <button class="suggestion-btn"
                    data-message="Explain this topic further, and give me background information">📚 Explain
                    Further</button>
                <button class="suggestion-btn" data-message="What actions should I take based on this information?">🎯
                    Action Items</button>
                <button class="suggestion-btn" data-message="What questions should I ask about this?">❓ Ask
                    Questions</button>
                <button class="suggestion-btn"
                    data-message="What are the advantages and disadvantages mentioned here?">⚖️ Pros & Cons</button>
                <button class="suggestion-btn" data-message="Please fact-check the main claims on this page">✅ Fact
                    Check</button>
                <button class="suggestion-btn"
                    data-message="What related topics should I explore to understand this better?">🔗 Related
                    Topics</button>
                <button class="suggestion-btn" data-message="Explain this in simple terms as if I'm a beginner">🎪
                    Simplify This</button>
                <button class="suggestion-btn"
                    data-message="Please analyze any charts, graphs, or visual data on this page">📈 Analyze
                    Charts</button>
                <button class="suggestion-btn"
                    data-message="Analyze the images on this page and provide: 1) Short description of what each image shows, 2) Key visual elements, colors, and composition, 3) Any text or data visible in the images, 4) Context and relevance to the page content, 5) Notable details or insights">🖼️
                    Analyze
                    Images</button>
                <button class="suggestion-btn"
                    data-message="What insights can you extract from the data on this page? Present any data in markdown table format with | separators.">📊
                    Data Insights</button>
                <button class="suggestion-btn"
                    data-message="Help me compare the different options or approaches mentioned">🔄 Compare
                    Options</button>
                <button class="suggestion-btn"
                    data-message="Compare the products on this page with: 1) Quick summary of each product, 2) Comparison table in markdown format with key features, 3) Similarities between products, 4) Key differences and which is better for what use case. Please format all tables using proper markdown table syntax with | separators.">⚖️
                    Compare Products</button>
                <button class="suggestion-btn" data-message="What trends or patterns do you notice in this content?">📈
                    Trends & Patterns</button>
                <button class="suggestion-btn"
                    data-message="Give me creative ideas or applications based on this content">🎨 Creative
                    Ideas</button>
                <button class="suggestion-btn"
                    data-message="Please provide a quick financial analysis of this page content">💰 Financial
                    Analysis</button>
                <button class="suggestion-btn"
                    data-message="Please extract and analyze all tables on this page. Format them as proper markdown tables with | separators and provide insights about the data.">📊
                    Extract Tables</button>
                <button class="suggestion-btn"
                    data-message="Generate study questions and flashcards for this content">🎓 Study Questions</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button id="closeSettingsButton" class="close-button">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="modelSelect">AI Model:</label>
                    <select id="modelSelect" class="model-select">
                        <option value="gemma3:4b">Gemma3 4B (Default)</option>
                        <option value="gemma3n:e4b">Gemma3N E4B (New)</option>
                    </select>
                    <div class="setting-description">
                        Choose the AI model to use for analysis. Different models may have different capabilities and
                        performance characteristics.
                    </div>
                </div>
                <div class="setting-group">
                    <label>Available Models:</label>
                    <div id="availableModels" class="available-models">
                        <div class="loading-models">Loading available models...</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveSettingsButton" class="save-button">Save Settings</button>
                <button id="cancelSettingsButton" class="cancel-button">Cancel</button>
            </div>
        </div>
    </div>

    <script src="sidebar.js"></script>
</body>

</html>